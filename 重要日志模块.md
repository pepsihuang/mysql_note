



# redo log

*InnoDB引擎层*

*WAL技术: Write-Ahead Logging, 先写日志,再写磁盘.*

当需要更新数据时 InnoDB引擎会先把记录写到 redo log里面. 并更新内存,这个时候更新就算完成了.

redo log是固定大小, 从头写到尾, 循环写. 

```mermaid
graph LR
A(区域A)-->B(区域B)
  B(区域B)-->C(区域C)
  C(区域C)-->D(区域D)
  D(区域D)-->A(区域A)
```

如果还没用完固定大小,那么引擎将会在空闲的时候把数据更新到磁盘.
如果更新内容特别多,当固定大小被写完时,将会先暂停别的事情,先把数据更新到磁盘.为新纪录腾出空间.

当数据库异常重启,数据也不丢失.此称之为: **crash-safe**


#binlog

*server层*

归档日志


...待补充

# 两个log对比

1. redo log 为InnoDB引擎特有, binlog为server层实现,所有引擎公用.
2. redo log 为物理日志(做了什么修改). binlog为逻辑日志(给xxx做xxx).
3. redo log 为循环写,固定空间会用完. binlog为可追加写入, 并不会覆盖以前的日志. 



# 两段提交









